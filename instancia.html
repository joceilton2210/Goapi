<!DOCTYPE html>

<html class="dark" lang="pt-BR">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    
    <!-- SEO Meta Tags -->
    <title>Gerenciar Inst√¢ncias WhatsApp - GO API WhatsApp Manager</title>
    <meta name="description" content="Gerencie suas inst√¢ncias do WhatsApp com a GO API. Crie, conecte e monitore m√∫ltiplas inst√¢ncias. Automa√ß√£o profissional de mensagens e integra√ß√µes.">
    <meta name="keywords" content="WhatsApp API, GO API, gerenciar inst√¢ncias WhatsApp, m√∫ltiplas inst√¢ncias, automa√ß√£o WhatsApp, API mensagens, webhook WhatsApp">
    <meta name="author" content="Time GO - Nakamura, Joceilton Gomes, Othon Righetti">
    <meta name="robots" content="index, follow">
    <meta name="language" content="pt-BR">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://goapi.com.br/instancia.html">
    <meta property="og:title" content="Gerenciar Inst√¢ncias WhatsApp - GO API">
    <meta property="og:description" content="Gerencie suas inst√¢ncias do WhatsApp com a GO API. Crie, conecte e monitore m√∫ltiplas inst√¢ncias de forma profissional.">
    <meta property="og:image" content="https://goapi.com.br/logo.png">
    <meta property="og:site_name" content="GO API WhatsApp">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://goapi.com.br/instancia.html">
    <meta name="twitter:title" content="Gerenciar Inst√¢ncias WhatsApp - GO API">
    <meta name="twitter:description" content="Gerencie suas inst√¢ncias do WhatsApp com a GO API. Crie, conecte e monitore m√∫ltiplas inst√¢ncias de forma profissional.">
    <meta name="twitter:image" content="https://goapi.com.br/logo.png">
    
    <!-- Favicons -->
    <link rel="icon" type="image/png" sizes="32x32" href="logo.png">
    <link rel="icon" type="image/png" sizes="16x16" href="logo.png">
    <link rel="apple-touch-icon" sizes="180x180" href="logo.png">
    <link rel="shortcut icon" href="logo.png" type="image/x-icon">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <!-- Global Config -->
    <script src="assets/js/config.js"></script>
    <!-- Custom Alert System -->
    <script src="assets/js/alert.js"></script>
    <!-- Tailwind Configuration -->
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#eaa800",
                        "primary-hover": "#1d66f0",
                        "background-light": "#f6f6f8",
                        "background-dark": "#111722",
                        "surface-dark": "#192233",
                        "surface-light": "#ffffff",
                        "border-dark": "#232f48",
                        "border-light": "#e2e8f0",
                        "text-secondary-dark": "#92a4c9",
                        "text-secondary-light": "#64748b",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    borderRadius: { "DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "2xl": "1rem", "full": "9999px" },
                },
            },
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
    </style>
</head>

<body
    class="bg-gray-50 dark:bg-background-dark min-h-screen flex flex-col font-display text-slate-900 dark:text-white transition-colors duration-200">
    <!-- Top Navigation -->
    <!-- Top Navigation -->
    <header
        class="border-b border-solid border-border-light dark:border-border-dark bg-surface-light dark:bg-surface-dark sticky top-0 z-50">
        <div class="flex items-center justify-center py-3 px-4 md:px-10 lg:px-20">
            <div class="flex items-center justify-between w-full max-w-[1200px]">
                <div class="flex items-center gap-6 text-slate-900 dark:text-white">
                    <img src="logo_black.png" alt="GO API Logo" class="h-12 w-auto object-contain dark:hidden">
                    <img src="logo_white.png" alt="GO API Logo" class="h-12 w-auto object-contain hidden dark:block">
                    <a href="instancia.html"
                        class="hidden md:block text-text-secondary-light dark:text-text-secondary-dark hover:text-white transition-colors text-sm font-medium">
                        Dashboard
                    </a>
                    <a href="documentacao.html"
                        class="hidden md:block text-primary font-semibold text-sm">
                        Documenta√ß√£o
                    </a>
                    <a href="integracao.html"
                        class="hidden md:block text-text-secondary-light dark:text-text-secondary-dark hover:text-white transition-colors text-sm font-medium">
                        Integra√ß√£o
                    </a>
                    <a href="envio.html"
                        class="hidden md:block text-primary font-semibold text-sm">
                        Enviar Mensagens
                    </a>
                </div>
                <div class="flex gap-6 items-center">
                    <button id="theme-toggle"
                        class="text-text-secondary-light dark:text-text-secondary-dark hover:text-white transition-colors">
                        <span class="material-symbols-outlined dark:hidden">light_mode</span>
                        <span class="material-symbols-outlined hidden dark:inline">dark_mode</span>
                    </button>
                    
                    <!-- Language Dropdown -->
                    <div class="relative">
                        <button id="language-toggle"
                            class="flex items-center gap-2 px-3 py-1.5 text-text-secondary-light dark:text-text-secondary-dark hover:text-white transition-colors text-sm font-semibold rounded-lg hover:bg-surface-dark">
                            <span class="material-symbols-outlined text-[18px]">language</span>
                            <span id="current-lang-text">PT</span>
                            <span class="material-symbols-outlined text-[14px]">expand_more</span>
                        </button>
                        
                        <div id="language-dropdown"
                            class="hidden absolute top-full right-0 mt-2 w-44 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-xl overflow-hidden z-50">
                            <button onclick="selectLanguage('pt')"
                                class="w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-left">
                                <span><img src="bra.png" alt="Bandeira Brasil" class="w-5 h-5 object-cover rounded"></span>
                                <span class="text-sm font-medium text-gray-700 dark:text-gray-200">Portugu√™s</span>
                            </button>
                            <button onclick="selectLanguage('en')"
                                class="w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-left">
                                <span><img src="usa.png" alt="Bandeira EUA" class="w-5 h-5 object-cover rounded"></span>
                                <span class="text-sm font-medium text-gray-700 dark:text-gray-200">English</span>
                            </button>
                            <button onclick="selectLanguage('es')"
                                class="w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-left">
                                <span><img src="esp.png" alt="Bandeira Espanha" class="w-5 h-5 object-cover rounded"></span>
                                <span class="text-sm font-medium text-gray-700 dark:text-gray-200">Espa√±ol</span>
                            </button>
                        </div>
                    </div>
                    <div class="h-8 w-[1px] bg-border-light dark:bg-border-dark"></div>
                    <div class="flex items-center gap-3">
                        <div class="text-right hidden sm:block">
                            <p id="user-name" class="text-sm font-semibold">Usu√°rio</p>
                            <p class="text-xs text-text-secondary-light dark:text-text-secondary-dark">GO API</p>
                        </div>
                        <div class="bg-center bg-no-repeat bg-cover rounded-full size-10 border-2 border-primary"
                            data-alt="User profile picture placeholder"
                            style='background-image: url("icone.png");'>
                        </div>
                        <button id="logout-btn" class="flex items-center gap-2 px-3 py-2 text-sm font-medium text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors">
                            <span class="material-symbols-outlined text-[18px]">logout</span>
                            <span class="hidden sm:inline">Sair</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <!-- Main Layout -->
    <div class="layout-container flex h-full grow flex-col">
        <div class="flex flex-1 justify-center py-8 px-4 md:px-10 lg:px-20">
            <div class="layout-content-container flex flex-col max-w-[1200px] flex-1 gap-8">
                <!-- Breadcrumbs -->
                <nav aria-label="Breadcrumb" class="flex px-4">
                    <ol class="inline-flex items-center space-x-1 md:space-x-3">
                        <li class="inline-flex items-center">
                            <a class="inline-flex items-center text-sm font-medium text-text-secondary-light dark:text-text-secondary-dark hover:text-primary dark:hover:text-primary"
                                href="#">
                                <span class="material-symbols-outlined text-[18px] mr-2">home</span>
                                <span data-i18n="home">Home</span>
                            </a>
                        </li>
                        <li>
                            <div class="flex items-center">
                                <span
                                    class="material-symbols-outlined text-text-secondary-light dark:text-text-secondary-dark text-[18px]">chevron_right</span>
                                <span
                                    class="ml-1 text-sm font-medium text-slate-900 dark:text-white md:ml-2" data-i18n="instances">Inst√¢ncias</span>
                            </div>
                        </li>
                    </ol>
                </nav>
                <!-- Page Heading -->
                <div class="flex flex-col md:flex-row justify-between gap-6 px-4">
                    <div class="flex flex-col gap-2">
                        <h1 class="text-3xl md:text-4xl font-black leading-tight tracking-[-0.033em] text-slate-900 dark:text-white" data-i18n="my-instances">
                            Gerenciar Inst√¢ncias
                        </h1>
                        <p class="text-text-secondary-light dark:text-text-secondary-dark text-base font-normal leading-normal max-w-2xl" data-i18n="instances-subtitle">
                            Gerencie suas conex√µes do WhatsApp API. Crie novas inst√¢ncias, verifique o status da conex√£o
                            e configure webhooks.
                        </p>
                    </div>
                    <div class="flex items-end">
                        <button
                            class="flex items-center gap-2 bg-surface-light dark:bg-surface-dark border border-border-light dark:border-border-dark hover:border-primary text-slate-900 dark:text-white px-4 py-2 rounded-lg transition-all text-sm font-medium">
                            <span class="material-symbols-outlined text-[20px]">refresh</span>
                            Atualizar Status
                        </button>
                    </div>
                </div>
                <!-- Create New Instance Card -->
                <div class="px-4">
                    <div
                        class="bg-surface-light dark:bg-surface-dark rounded-xl border border-border-light dark:border-border-dark p-6 shadow-sm">
                        <div class="flex flex-col lg:flex-row gap-8 items-start">
                            <div class="flex-1 w-full">
                                <h3 class="text-lg font-bold text-slate-900 dark:text-white mb-1" data-i18n="new-connection">Nova Conex√£o</h3>
                                <p class="text-text-secondary-light dark:text-text-secondary-dark text-sm mb-6" data-i18n="connection-desc">D√™ um
                                    nome amig√°vel para identificar sua nova sess√£o do WhatsApp.</p>
                                <div class="flex flex-col sm:flex-row gap-4 items-end">
                                    <div class="w-full sm:flex-1">
                                        <label
                                            class="block text-sm font-medium text-slate-900 dark:text-white mb-2" data-i18n="instance-name">Nome
                                            da Inst√¢ncia</label>
                                        <div class="relative">
                                            <div
                                                class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                                <span
                                                    class="material-symbols-outlined text-text-secondary-light dark:text-text-secondary-dark">label</span>
                                            </div>
                                            <input id="instance-name-input"
                                                class="w-full bg-slate-50 dark:bg-[#111722] border border-border-light dark:border-border-dark text-slate-900 dark:text-white text-sm rounded-lg focus:ring-primary focus:border-primary block pl-10 p-3 placeholder-text-secondary-light dark:placeholder-text-secondary-dark transition-all"
                                                placeholder="Ex: Marketing - Vendas" type="text" />
                                        </div>
                                    </div>
                                    <button id="create-instance-btn"
                                        class="w-full sm:w-auto flex items-center justify-center gap-2 bg-primary hover:bg-white hover:text-slate-900 text-slate-900 font-medium rounded-lg text-sm px-6 py-3 transition-all shadow-lg shadow-primary/20">
                                        <span class="material-symbols-outlined text-[20px]">add_circle</span>
                                        <span data-i18n="create-instance">Criar Inst√¢ncia</span>
                                    </button>
                                </div>
                            </div>
                            <div class="hidden lg:block w-px bg-border-light dark:bg-border-dark self-stretch"></div>
                            <div class="w-full lg:w-1/3">
                                <div
                                    class="rounded-lg bg-blue-50 dark:bg-blue-900/20 p-4 border border-blue-100 dark:border-blue-900/30">
                                    <div class="flex gap-3">
                                        <span class="material-symbols-outlined text-primary mt-1">info</span>
                                        <div>
                                            <h4 class="text-sm font-bold text-slate-900 dark:text-white mb-1" data-i18n="how-it-works">Como
                                                funciona?</h4>
                                            <p
                                                class="text-xs text-text-secondary-light dark:text-text-secondary-dark leading-relaxed" data-i18n="how-desc">
                                                Ao criar uma inst√¢ncia, um QR Code ser√° gerado. Voc√™ precisar√°
                                                escane√°-lo com seu aplicativo WhatsApp (Menu &gt; Aparelhos conectados)
                                                para estabelecer a conex√£o.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Existing Instances Section -->
                <div class="flex flex-col gap-4 px-4 mt-4">
                    <div class="flex flex-col sm:flex-row justify-between items-center gap-4">
                        <h3 class="text-xl font-bold text-slate-900 dark:text-white flex items-center gap-2">
                            Inst√¢ncias Ativas
                            <span id="instance-count"
                                class="bg-primary/10 text-primary text-xs font-bold px-2.5 py-0.5 rounded-full border border-primary/20">0</span>
                        </h3>
                        <div class="relative w-full sm:w-72">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <span
                                    class="material-symbols-outlined text-text-secondary-light dark:text-text-secondary-dark text-[20px]">search</span>
                            </div>
                            <input
                                class="w-full bg-surface-light dark:bg-surface-dark border border-border-light dark:border-border-dark text-slate-900 dark:text-white text-sm rounded-lg focus:ring-primary focus:border-primary block pl-10 p-2.5 placeholder-text-secondary-light dark:placeholder-text-secondary-dark"
                                placeholder="Buscar inst√¢ncia..." type="text" />
                        </div>
                    </div>
                    <!-- Instances Grid -->
                    <div id="instances-grid" class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 mt-2">
                        <!-- Cards ser√£o inseridos aqui dinamicamente -->
                    </div>
                </div>
                <!-- Footer Section (Optional for context) -->
                <div class="px-4 mt-8 pb-10 flex flex-col items-center">
                    <p class="text-text-secondary-light dark:text-text-secondary-dark text-sm text-center">
                        Precisa de ajuda com a integra√ß√£o? <a class="text-primary hover:underline" href="#">Consulte a
                            documenta√ß√£o</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer Bar - Full Width -->
    <footer class="fixed bottom-0 left-0 right-0 w-full bg-gray-800 dark:bg-gray-900 border-t border-gray-700 dark:border-gray-800 py-3 z-50">
        <div class="flex items-center justify-center gap-2 text-sm text-gray-200">
            <span class="text-primary">GO API Whatsapp</span>
            <span class="group relative cursor-help">
                <span class="group-hover:hidden">Time GO</span>
                <span class="hidden group-hover:inline"><strong> Nakamura</strong> / <strong>Joceilton Gomes</strong> / <strong>Augusto Oliveira</strong> / <strong>Othon Righetti</strong></span>
            </span>
        </div>
    </footer>  

    <script>
        // Theme toggle functionality
        const themeToggle = document.getElementById('theme-toggle');
        const html = document.documentElement;

        // Check for saved theme preference or default to 'dark'
        const currentTheme = localStorage.getItem('theme') || 'dark';
        html.classList.toggle('dark', currentTheme === 'dark');

        themeToggle.addEventListener('click', () => {
            html.classList.toggle('dark');
            const newTheme = html.classList.contains('dark') ? 'dark' : 'light';
            localStorage.setItem('theme', newTheme);
        });

        // Language toggle functionality
        
        // Translations object - MUST be declared first
        const translations = {
            'pt': {
                // Breadcrumbs
                'home': 'Home',
                'instances': 'Inst√¢ncias',
                
                // Main section
                'my-instances': 'Minhas Inst√¢ncias',
                'instances-subtitle': 'Gerencie todas as suas conex√µes do WhatsApp em um s√≥ lugar',
                
                // New connection card
                'new-connection': 'Nova Conex√£o',
                'connection-desc': 'D√™ um nome amig√°vel para identificar sua nova sess√£o do WhatsApp.',
                'instance-name': 'Nome da Inst√¢ncia',
                'instance-placeholder': 'Ex: Marketing - Vendas',
                'create-instance': 'Criar Inst√¢ncia',
                'how-it-works': 'Como funciona?',
                'how-desc': 'Ao criar uma inst√¢ncia, um QR Code ser√° gerado. Voc√™ precisar√° escane√°-lo com seu aplicativo WhatsApp (Menu > Aparelhos conectados) para estabelecer a conex√£o.',
                
                // Instance cards
                'connected': 'Conectado',
                'disconnected': 'Desconectado',
                'connecting': 'Conectando',
                'configure': 'Configurar',
                'reconnect': 'Reconectar',
                'show-qr': 'Exibir QR Code',
                'expires-in': 'Expira em',
                'auth-failed': 'Falha na autentica√ß√£o',
                'waiting-scan': 'Aguardando escaneamento'
            },
            'en': {
                // Breadcrumbs
                'home': 'Home',
                'instances': 'Instances',
                
                // Main section
                'my-instances': 'My Instances',
                'instances-subtitle': 'Manage all your WhatsApp connections in one place',
                
                // New connection card
                'new-connection': 'New Connection',
                'connection-desc': 'Give a friendly name to identify your new WhatsApp session.',
                'instance-name': 'Instance Name',
                'instance-placeholder': 'Ex: Marketing - Sales',
                'create-instance': 'Create Instance',
                'how-it-works': 'How it works?',
                'how-desc': 'When creating an instance, a QR Code will be generated. You will need to scan it with your WhatsApp app (Menu > Linked Devices) to establish the connection.',
                
                // Instance cards
                'connected': 'Connected',
                'disconnected': 'Disconnected',
                'connecting': 'Connecting',
                'configure': 'Configure',
                'reconnect': 'Reconnect',
                'show-qr': 'Show QR Code',
                'expires-in': 'Expires in',
                'auth-failed': 'Authentication failed',
                'waiting-scan': 'Waiting for scan'
            },
            'es': {
                // Breadcrumbs
                'home': 'Inicio',
                'instances': 'Instancias',
                
                // Main section
                'my-instances': 'Mis Instancias',
                'instances-subtitle': 'Administra todas tus conexiones de WhatsApp en un solo lugar',
                
                // New connection card
                'new-connection': 'Nueva Conexi√≥n',
                'connection-desc': 'Dale un nombre amigable para identificar tu nueva sesi√≥n de WhatsApp.',
                'instance-name': 'Nombre de la Instancia',
                'instance-placeholder': 'Ej: Marketing - Ventas',
                'create-instance': 'Crear Instancia',
                'how-it-works': '¬øC√≥mo funciona?',
                'how-desc': 'Al crear una instancia, se generar√° un c√≥digo QR. Deber√°s escanearlo con tu aplicaci√≥n de WhatsApp (Men√∫ > Dispositivos vinculados) para establecer la conexi√≥n.',
                
                // Instance cards
                'connected': 'Conectado',
                'disconnected': 'Desconectado',
                'connecting': 'Conectando',
                'configure': 'Configurar',
                'reconnect': 'Reconectar',
                'show-qr': 'Mostrar C√≥digo QR',
                'expires-in': 'Expira en',
                'auth-failed': 'Fallo de autenticaci√≥n',
                'waiting-scan': 'Esperando escaneo'
            }
        };

        const languageToggle = document.getElementById('language-toggle');
        const languageDropdown = document.getElementById('language-dropdown');
        const currentLangText = document.getElementById('current-lang-text');
        let currentLanguage = localStorage.getItem('language') || 'pt';

        const languageNames = {
            'pt': 'Portugu√™s',
            'en': 'English',
            'es': 'Espa√±ol'
        };

        function changeLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('language', lang);
            currentLangText.textContent = languageNames[lang];
            
            // Update all translatable elements
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (translations[lang] && translations[lang][key]) {
                    element.innerHTML = translations[lang][key];
                }
            });
            
            // Close dropdown
            languageDropdown.classList.add('hidden');
        }

        // Toggle dropdown
        languageToggle.addEventListener('click', () => {
            languageDropdown.classList.toggle('hidden');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!languageToggle.contains(e.target) && !languageDropdown.contains(e.target)) {
                languageDropdown.classList.add('hidden');
            }
        });

        // Function to select language (called from dropdown buttons)
        function selectLanguage(lang) {
            changeLanguage(lang);
        }

        // Initialize language
        changeLanguage(currentLanguage);

        // Simple MD5 hash function
        function md5(string) {
            function rotateLeft(value, shift) {
                return (value << shift) | (value >>> (32 - shift));
            }
            
            function addUnsigned(x, y) {
                const lsw = (x & 0xFFFF) + (y & 0xFFFF);
                const msw = (x >> 16) + (y >> 16) + (lsw >> 16);
                return (msw << 16) | (lsw & 0xFFFF);
            }
            
            function md5cmn(q, a, b, x, s, t) {
                return addUnsigned(rotateLeft(addUnsigned(addUnsigned(a, q), addUnsigned(x, t)), s), b);
            }
            
            function md5ff(a, b, c, d, x, s, t) {
                return md5cmn((b & c) | ((~b) & d), a, b, x, s, t);
            }
            
            function md5gg(a, b, c, d, x, s, t) {
                return md5cmn((b & d) | (c & (~d)), a, b, x, s, t);
            }
            
            function md5hh(a, b, c, d, x, s, t) {
                return md5cmn(b ^ c ^ d, a, b, x, s, t);
            }
            
            function md5ii(a, b, c, d, x, s, t) {
                return md5cmn(c ^ (b | (~d)), a, b, x, s, t);
            }
            
            function convertToWordArray(string) {
                let wordArray = [];
                for (let i = 0; i < string.length * 8; i += 8) {
                    wordArray[i >> 5] |= (string.charCodeAt(i / 8) & 0xFF) << (i % 32);
                }
                return wordArray;
            }
            
            function wordToHex(value) {
                let hex = '';
                for (let i = 0; i < 4; i++) {
                    hex += ((value >> (i * 8 + 4)) & 0x0F).toString(16) + ((value >> (i * 8)) & 0x0F).toString(16);
                }
                return hex;
            }
            
            const x = convertToWordArray(string);
            let a = 0x67452301;
            let b = 0xEFCDAB89;
            let c = 0x98BADCFE;
            let d = 0x10325476;
            
            x[string.length * 8 >> 5] |= 0x80 << (string.length * 8 % 32);
            x[(((string.length * 8 + 64) >>> 9) << 4) + 14] = string.length * 8;
            
            for (let i = 0; i < x.length; i += 16) {
                const oldA = a, oldB = b, oldC = c, oldD = d;
                
                a = md5ff(a, b, c, d, x[i + 0], 7, 0xD76AA478);
                d = md5ff(d, a, b, c, x[i + 1], 12, 0xE8C7B756);
                c = md5ff(c, d, a, b, x[i + 2], 17, 0x242070DB);
                b = md5ff(b, c, d, a, x[i + 3], 22, 0xC1BDCEEE);
                a = md5ff(a, b, c, d, x[i + 4], 7, 0xF57C0FAF);
                d = md5ff(d, a, b, c, x[i + 5], 12, 0x4787C62A);
                c = md5ff(c, d, a, b, x[i + 6], 17, 0xA8304613);
                b = md5ff(b, c, d, a, x[i + 7], 22, 0xFD469501);
                a = md5ff(a, b, c, d, x[i + 8], 7, 0x698098D8);
                d = md5ff(d, a, b, c, x[i + 9], 12, 0x8B44F7AF);
                c = md5ff(c, d, a, b, x[i + 10], 17, 0xFFFF5BB1);
                b = md5ff(b, c, d, a, x[i + 11], 22, 0x895CD7BE);
                a = md5ff(a, b, c, d, x[i + 12], 7, 0x6B901122);
                d = md5ff(d, a, b, c, x[i + 13], 12, 0xFD987193);
                c = md5ff(c, d, a, b, x[i + 14], 17, 0xA679438E);
                b = md5ff(b, c, d, a, x[i + 15], 22, 0x49B40821);
                
                a = md5gg(a, b, c, d, x[i + 1], 5, 0xF61E2562);
                d = md5gg(d, a, b, c, x[i + 6], 9, 0xC040B340);
                c = md5gg(c, d, a, b, x[i + 11], 14, 0x265E5A51);
                b = md5gg(b, c, d, a, x[i + 0], 20, 0xE9B6C7AA);
                a = md5gg(a, b, c, d, x[i + 5], 5, 0xD62F105D);
                d = md5gg(d, a, b, c, x[i + 10], 9, 0x02441453);
                c = md5gg(c, d, a, b, x[i + 15], 14, 0xD8A1E681);
                b = md5gg(b, c, d, a, x[i + 4], 20, 0xE7D3FBC8);
                a = md5gg(a, b, c, d, x[i + 9], 5, 0x21E1CDE6);
                d = md5gg(d, a, b, c, x[i + 14], 9, 0xC33707D6);
                c = md5gg(c, d, a, b, x[i + 3], 14, 0xF4D50D87);
                b = md5gg(b, c, d, a, x[i + 8], 20, 0x455A14ED);
                a = md5gg(a, b, c, d, x[i + 13], 5, 0xA9E3E905);
                d = md5gg(d, a, b, c, x[i + 2], 9, 0xFCEFA3F8);
                c = md5gg(c, d, a, b, x[i + 7], 14, 0x676F02D9);
                b = md5gg(b, c, d, a, x[i + 12], 20, 0x8D2A4C8A);
                
                a = md5hh(a, b, c, d, x[i + 5], 4, 0xFFFA3942);
                d = md5hh(d, a, b, c, x[i + 8], 11, 0x8771F681);
                c = md5hh(c, d, a, b, x[i + 11], 16, 0x6D9D6122);
                b = md5hh(b, c, d, a, x[i + 14], 23, 0xFDE5380C);
                a = md5hh(a, b, c, d, x[i + 1], 4, 0xA4BEEA44);
                d = md5hh(d, a, b, c, x[i + 4], 11, 0x4BDECFA9);
                c = md5hh(c, d, a, b, x[i + 7], 16, 0xF6BB4B60);
                b = md5hh(b, c, d, a, x[i + 10], 23, 0xBEBFBC70);
                a = md5hh(a, b, c, d, x[i + 13], 4, 0x289B7EC6);
                d = md5hh(d, a, b, c, x[i + 0], 11, 0xEAA127FA);
                c = md5hh(c, d, a, b, x[i + 3], 16, 0xD4EF3085);
                b = md5hh(b, c, d, a, x[i + 6], 23, 0x04881D05);
                a = md5hh(a, b, c, d, x[i + 9], 4, 0xD9D4D039);
                d = md5hh(d, a, b, c, x[i + 12], 11, 0xE6DB99E5);
                c = md5hh(c, d, a, b, x[i + 15], 16, 0x1FA27CF8);
                b = md5hh(b, c, d, a, x[i + 2], 23, 0xC4AC5665);
                
                a = md5ii(a, b, c, d, x[i + 0], 6, 0xF4292244);
                d = md5ii(d, a, b, c, x[i + 7], 10, 0x432AFF97);
                c = md5ii(c, d, a, b, x[i + 14], 15, 0xAB9423A7);
                b = md5ii(b, c, d, a, x[i + 5], 21, 0xFC93A039);
                a = md5ii(a, b, c, d, x[i + 12], 6, 0x655B59C3);
                d = md5ii(d, a, b, c, x[i + 3], 10, 0x8F0CCC92);
                c = md5ii(c, d, a, b, x[i + 10], 15, 0xFFEFF47D);
                b = md5ii(b, c, d, a, x[i + 1], 21, 0x85845DD1);
                a = md5ii(a, b, c, d, x[i + 8], 6, 0x6FA87E4F);
                d = md5ii(d, a, b, c, x[i + 15], 10, 0xFE2CE6E0);
                c = md5ii(c, d, a, b, x[i + 6], 15, 0xA3014314);
                b = md5ii(b, c, d, a, x[i + 13], 21, 0x4E0811A1);
                a = md5ii(a, b, c, d, x[i + 4], 6, 0xF7537E82);
                d = md5ii(d, a, b, c, x[i + 11], 10, 0xBD3AF235);
                c = md5ii(c, d, a, b, x[i + 2], 15, 0x2AD7D2BB);
                b = md5ii(b, c, d, a, x[i + 9], 21, 0xEB86D391);
                
                a = addUnsigned(a, oldA);
                b = addUnsigned(b, oldB);
                c = addUnsigned(c, oldC);
                d = addUnsigned(d, oldD);
            }
            
            return (wordToHex(a) + wordToHex(b) + wordToHex(c) + wordToHex(d)).toLowerCase();
        }

        // Auth & Config
        if (!localStorage.getItem('user_token')) {
            window.location.href = 'login.html';
        }

        // Exibir nome do usu√°rio
        const userName = localStorage.getItem('user_name') || 'Usu√°rio';
        document.getElementById('user-name').textContent = userName;

        // Bot√£o de logout
        document.getElementById('logout-btn').addEventListener('click', () => {
            showConfirm(
                'Tem certeza que deseja sair?',
                () => {
                    localStorage.removeItem('user_token');
                    localStorage.removeItem('user_name');
                    showSuccess('Logout realizado com sucesso!', 'At√© logo!');
                    setTimeout(() => {
                        window.location.href = 'login.html';
                    }, 1000);
                },
                null,
                'Confirmar Logout'
            );
        });

        // Usar configura√ß√£o global
        const API_CONFIG = window.GO_API_CONFIG || {
            baseUrl: window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
                ? 'http://localhost:4000/api'
                : `${window.location.protocol}//${window.location.host}/api`,
            apiKey: 'change-this-key'
        };

        // API Integration
        async function fetchInstances() {
            try {
                const response = await fetch(`${API_CONFIG.baseUrl}/instances`, {
                    headers: { 'x-api-key': API_CONFIG.apiKey }
                });
                const data = await response.json();
                
                if (data.success) {
                    renderInstances(data.data);
                    document.getElementById('instance-count').textContent = data.data.length;
                }
            } catch (error) {
                console.error('Error fetching instances:', error);
                document.getElementById('instances-grid').innerHTML = '<div class="col-span-full text-center py-12"><p class="text-text-secondary-light dark:text-text-secondary-dark">Erro ao carregar inst√¢ncias. Verifique se a API est√° rodando.</p></div>'; 
            }
        }

        async function createInstance(instanceName) {
            if (!instanceName || instanceName.trim() === '') {
                showWarning('Por favor, insira um nome para a inst√¢ncia');
                return;
            }

            try {
                const response = await fetch(`${API_CONFIG.baseUrl}/instances`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'x-api-key': API_CONFIG.apiKey
                    },
                    body: JSON.stringify({ instanceId: instanceName.trim() })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showSuccess('Inst√¢ncia criada com sucesso! Redirecionando...', 'Sucesso!');
                    setTimeout(() => {
                        window.location.href = `qr.html?instance=${encodeURIComponent(instanceName.trim())}`;
                    }, 1500);
                } else {
                    showError(data.message || 'Erro desconhecido ao criar inst√¢ncia');
                }
            } catch (error) {
                console.error('Error creating instance:', error);
                showError('Erro ao conectar com o servidor. Verifique se a API est√° rodando.');
            }
        }

        async function deleteInstance(instanceId) {
            showConfirm(
                `Tem certeza que deseja deletar a inst√¢ncia "${instanceId}"? Esta a√ß√£o n√£o pode ser desfeita.`,
                async () => {
                    try {
                        console.log(`üóëÔ∏è Deletando inst√¢ncia: ${instanceId}`);
                        
                        const response = await fetch(`${API_CONFIG.baseUrl}/instances/${instanceId}`, {
                            method: 'DELETE',
                            headers: { 'x-api-key': API_CONFIG.apiKey }
                        });
                        
                        console.log('Response status:', response.status);
                        console.log('Response ok:', response.ok);
                        
                        if (!response.ok) {
                            const errorText = await response.text();
                            console.error('Error response:', errorText);
                            showError(`Erro HTTP ${response.status}: ${errorText}`);
                            return;
                        }
                        
                        const data = await response.json();
                        console.log('Delete response:', data);
                        
                        if (data.success) {
                            showSuccess('Inst√¢ncia deletada com sucesso!');
                            setTimeout(() => fetchInstances(), 1000);
                        } else {
                            console.error('Delete failed:', data);
                            showError(data.message || 'Erro desconhecido ao deletar inst√¢ncia');
                        }
                    } catch (error) {
                        console.error('‚ùå Error deleting instance:', error);
                        console.error('Error stack:', error.stack);
                        showError(`Erro ao deletar: ${error.message}`);
                    }
                },
                null,
                'Confirmar Exclus√£o'
            );
        }

        function renderInstances(instances) {
            const grid = document.getElementById('instances-grid');
            
            if (!instances || instances.length === 0) {
                grid.innerHTML = '<div class="col-span-full text-center py-12">' +
                    '<div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-gray-100 dark:bg-gray-800 mb-4">' +
                    '<span class="material-symbols-outlined text-4xl text-gray-400">inbox</span>' +
                    '</div>' +
                    '<p class="text-text-secondary-light dark:text-text-secondary-dark text-lg">Nenhuma inst√¢ncia criada ainda</p>' +
                    '<p class="text-text-secondary-light dark:text-text-secondary-dark text-sm mt-2">Crie sua primeira inst√¢ncia acima</p>' +
                    '</div>';
                return;
            }

            const cards = instances.map(instance => {
                const isConnected = instance.isConnected;
                const statusColor = isConnected ? 'green' : 'red';
                const statusText = isConnected ? (translations[currentLanguage]['connected'] || 'Conectado') : (translations[currentLanguage]['disconnected'] || 'Desconectado');
                const statusIcon = isConnected ? 'chat' : 'link_off';
                
                let actionButtons = '';
                if (isConnected) {
                    actionButtons = '<div class="text-xs text-text-secondary-light dark:text-text-secondary-dark flex items-center gap-1">' +
                        '<span class="material-symbols-outlined text-[16px]">check_circle</span>' +
                        'Ativo' +
                        '</div>' +
                        '<button class="text-primary hover:text-primary-hover text-sm font-semibold flex items-center gap-1 transition-colors">' +
                        '<span data-i18n="configure">Configurar</span>' +
                        '<span class="material-symbols-outlined text-[16px]">settings</span>' +
                        '</button>';
                } else {
                    actionButtons = '<div class="text-xs text-text-secondary-light dark:text-text-secondary-dark flex items-center gap-1">' +
                        '<span class="material-symbols-outlined text-[16px]">error</span>' +
                        'Desconectado' +
                        '</div>' +
                        '<a href="qr.html?instance=' + encodeURIComponent(instance.instanceId) + '" class="bg-primary/10 hover:bg-primary/20 text-slate-900 dark:text-white text-sm font-semibold px-3 py-1.5 rounded transition-colors flex items-center gap-1">' +
                        '<span data-i18n="reconnect">Reconectar</span>' +
                        '<span class="material-symbols-outlined text-[16px]">qr_code</span>' +
                        '</a>';
                }
                
                return '<div class="group relative bg-surface-light dark:bg-surface-dark rounded-xl border border-border-light dark:border-border-dark p-5 hover:border-primary/50 transition-all shadow-sm hover:shadow-md">' +
                    '<div class="absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity">' +
                    '<button onclick="deleteInstance(\'' + instance.instanceId + '\')" class="p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors" title="Deletar">' +
                    '<span class="material-symbols-outlined text-[20px]">delete</span>' +
                    '</button>' +
                    '</div>' +
                    '<div class="flex justify-between items-start mb-4">' +
                    '<div class="flex items-center gap-3">' +
                    '<div class="size-12 rounded-full bg-' + statusColor + '-100 dark:bg-' + statusColor + '-900/30 flex items-center justify-center text-' + statusColor + '-600 dark:text-' + statusColor + '-400">' +
                    '<span class="material-symbols-outlined">' + statusIcon + '</span>' +
                    '</div>' +
                    '<div>' +
                    '<h4 class="font-bold text-slate-900 dark:text-white text-lg">' + instance.instanceId + '</h4>' +
                    '<p class="text-xs text-text-secondary-light dark:text-text-secondary-dark font-mono">ID: ' + md5(instance.instanceId) + '</p>' +
                    '</div>' +
                    '</div>' +
                    '</div>' +
                    '<div class="flex items-center gap-2 mb-6">' +
                    '<div class="h-2.5 w-2.5 rounded-full bg-' + statusColor + '-500' + (isConnected ? ' animate-pulse' : '') + '"></div>' +
                    '<span class="text-sm font-medium text-' + statusColor + '-600 dark:text-' + statusColor + '-400">' + statusText + '</span>' +
                    '</div>' +
                    '<div class="flex items-center justify-between pt-4 border-t border-border-light dark:border-border-dark gap-2">' +
                    actionButtons +
                    '</div>' +
                    '</div>';
            });
            
            grid.innerHTML = cards.join('');
        }
        
        // Event listeners
        document.getElementById('create-instance-btn').addEventListener('click', () => {
            const instanceName = document.getElementById('instance-name-input').value;
            createInstance(instanceName);
        });

        document.getElementById('instance-name-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                const instanceName = document.getElementById('instance-name-input').value;
                createInstance(instanceName);
            }
        });
        
        // Load instances on start
        fetchInstances();
        
        // Auto-refresh every 10 seconds
        setInterval(fetchInstances, 10000);

    </script>
</body>

</html>